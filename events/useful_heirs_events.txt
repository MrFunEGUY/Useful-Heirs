######################
# Useful Heir Events #
######################

namespace = usefulheirs

# Heir Summoned
country_event = {
	id = usefulheirs.1000
	title = usefulheirs.1000.name
	desc = usefulheirs.1000.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:heir_leader
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Nevermind
	option = {
		name = usefulheirs.1000.d
	}

	# You need to gain experience within our empire.
	option = {
		name = usefulheirs.1000.a
		custom_tooltip = usefulheirs.1000.a.tooltip
		hidden_effect = { country_event = { id = usefulheirs.2000 } }
	}

	# You are unworthy of being my heir.
	option = {
		trigger	 = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
		name = usefulheirs.1000.b
		custom_tooltip = usefulheirs.1000.b.tooltip
		hidden_effect = { country_event = { id = usefulheirs.3000 } }
	}

	# The time has come to designate an heir.
	option = {
		trigger	 = { has_valid_civic = civic_adoptive_dynasties }
		name = usefulheirs.1000.b.ad
		custom_tooltip = usefulheirs.1000.b.tooltip
		hidden_effect = { country_event = { id = usefulheirs.3000 } }
	}

	# I shall abdicate, and you shall rule.
	option = {
		name = usefulheirs.1000.c
		custom_tooltip = usefulheirs.1000.c.tooltip
		hidden_effect = { country_event = { id = usefulheirs.4000 } }
	}
}

######################

# Pick heir job
country_event = {
	id = usefulheirs.2000
	title = usefulheirs.1000.name
	desc = usefulheirs.2000.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:heir_leader
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Set Initial Heir name color flag
	immediate = {
		if = {
			limit = { NOT = { has_country_flag = useful_heirs_check } }
			set_country_flag = useful_heirs_check
			set_country_flag = heir_name_color_deactivated
		}
	}

	# Nevermind
	option = {
		name = usefulheirs.2000.back
		trigger = {
			is_ai = no
		}
	}

	# Governor
	option = {
		name = usefulheirs.2000.a
		trigger = { event_target:heir_leader = { NOT = { leader_class = governor } } }
		hidden_effect = { country_event = { id = usefulheirs.2001 } }
		ai_chance = { factor = 6 }
	}

	# Admiral
	option = {
		name = usefulheirs.2000.b
		trigger = { event_target:heir_leader = { NOT = { leader_class = admiral } } }
		hidden_effect = { country_event = { id = usefulheirs.2002 } }
		ai_chance = { factor = 5 }
	}

	# General
	option = {
		name = usefulheirs.2000.c
		trigger = { event_target:heir_leader = { NOT = { leader_class = general } } }
		hidden_effect = { country_event = { id = usefulheirs.2003 } }
		ai_chance = { factor = 3 }
	}

	# Scientist
	option = {
		name = usefulheirs.2000.d
		trigger = { event_target:heir_leader = { NOT = { leader_class = scientist } } }
		hidden_effect = { country_event = { id = usefulheirs.2004 } }
		ai_chance = { factor = 1 }
	}

	# Heir Name Color
	option = {
		name = usefulheirs.2000.name_color_deactivated
		custom_tooltip = usefulheirs.2000.name_color_deactivated.tooltip
		trigger = {
			is_ai = no
			has_country_flag = heir_name_color_deactivated
		}
		hidden_effect = {
			set_country_flag = heir_name_color_activated
			remove_country_flag = heir_name_color_deactivated
			country_event = { id = usefulheirs.2000 }
		}
	}

	# Heir Name Color
	option = {
		name = usefulheirs.2000.name_color_activated
		trigger = {
			is_ai = no
			has_country_flag = heir_name_color_activated
		}
		hidden_effect = {
			set_country_flag = heir_name_color_deactivated
			remove_country_flag = heir_name_color_activated
			country_event = { id = usefulheirs.2000 }
		}
	}
}

# Governor
country_event = {
	id = usefulheirs.2001
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		clone_leader = {
			target = event_target:heir_leader
			class = governor
			effect = {
				get_heir_leader_clone_effect = yes
			}
		}

		get_heir_leader_switch_effect = yes
	}
}

# Admiral
country_event = {
	id = usefulheirs.2002
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		clone_leader = {
			target = event_target:heir_leader
			class = admiral
			effect = {
				get_heir_leader_clone_effect = yes
			}
		}

		get_heir_leader_switch_effect = yes
	}
}

# General
country_event = {
	id = usefulheirs.2003
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		clone_leader = {
			target = event_target:heir_leader
			class = general
			effect = {
				get_heir_leader_clone_effect = yes
			}
		}

		get_heir_leader_switch_effect = yes
	}
}

# Scientist
country_event = {
	id = usefulheirs.2004
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		clone_leader = {
			target = event_target:heir_leader
			class = scientist
			effect = {
				get_heir_leader_clone_effect = yes
			}
		}

		get_heir_leader_switch_effect = yes
	}
}

#############################

# Designate any leader as your heir
country_event = {
	id = usefulheirs.3000
	title = usefulheirs.1000.name

	desc = {
		text = usefulheirs.3000.desc
		trigger = {
			OR = {
				NOT = { has_valid_civic = civic_adoptive_dynasties }
				heir = { has_leader_flag = appointed_heir }
			}
		}
	}
	desc = {
		text = usefulheirs.3000.ad.desc
		trigger = { has_valid_civic = civic_adoptive_dynasties }
	}
	
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:heir_leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}

	immediate = {
		set_variable = { which = monthly_unity_prod value = 0 }

		export_trigger_value_to_variable = {
			trigger = resource_income_compare
			parameters = { resource = unity }
			variable = monthly_unity_prod
			rounded = yes
		}

		multiply_variable = { which = monthly_unity_prod value = 12 }
	}

	# Nevermind
	option = {
		name = {
			text = usefulheirs.3000.f
			trigger = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
		}
		name = {
			text = usefulheirs.3000.f.ad
			trigger = { has_valid_civic = civic_adoptive_dynasties }
		}
		hidden_effect = { clear_variable = monthly_unity_prod }
	}

	# Governor
	option = {
		name = usefulheirs.3000.a
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = governor }
		}
		hidden_effect = { get_governors_heir = yes }
		ai_chance = { factor = 5 }
	}

	# Admiral
	option = {
		name = usefulheirs.3000.b
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = admiral }
		}
		hidden_effect = { get_admirals_heir = yes }
		ai_chance = { factor = 4 }
	}

	# General
	option = {
		name = usefulheirs.3000.c
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = general }
		}
		hidden_effect = { get_generals_heir = yes }
		ai_chance = { factor = 4 }
	}

	# Scientist
	option = {
		name = usefulheirs.3000.d
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = scientist }
		}
		hidden_effect = { get_scientists_heir = yes }
		ai_chance = { factor = 1 }
	}

	# Just disinherit them
	option = {
		name = usefulheirs.3000.e
		hidden_effect = {
			if = {
				limit =  { has_global_flag = civil_wars_active }
				if = {
					limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
					heir_setup_non_ad_just_disinherit = yes
				}
				else_if = {
					limit = {
						has_valid_civic = civic_adoptive_dynasties
						heir = { has_leader_flag = appointed_heir }
					}
					heir_setup_ad_just_disinherit = yes
				}
			}
			heir = { kill_leader = { show_notification = no } }
		}
		ai_chance = { factor = 0 }
	}
}

# Designate any leader as your heir if you dont have an heir already
country_event = {
	id = usefulheirs.3100
	title = usefulheirs.3100.name
	desc = usefulheirs.3100.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}

	immediate = {
		set_variable = { which = monthly_unity_prod value = 0 }

		export_trigger_value_to_variable = {
			trigger = resource_income_compare
			parameters = { resource = unity }
			variable = monthly_unity_prod
			rounded = yes
		}

		multiply_variable = { which = monthly_unity_prod value = 24 }
	}

	# Nevermind
	option = {
		name = {
			text = usefulheirs.3000.f
			trigger = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
		}
		name = {
			text = usefulheirs.3000.f.ad
			trigger = { has_valid_civic = civic_adoptive_dynasties }
		}
		hidden_effect = { clear_variable = monthly_unity_prod }
	}

	# Governor
	option = {
		name = usefulheirs.3000.a
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = governor }
		}
		hidden_effect = { get_governors_heir = yes }
		ai_chance = { factor = 5 }
	}

	# Admiral
	option = {
		name = usefulheirs.3000.b
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = admiral }
		}
		hidden_effect = { get_admirals_heir = yes }
		ai_chance = { factor = 4 }
	}

	# General
	option = {
		name = usefulheirs.3000.c
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = general }
		}
		hidden_effect = { get_generals_heir = yes }
		ai_chance = { factor = 4 }
	}

	# Scientist
	option = {
		name = usefulheirs.3000.d
		allow = {
			if = {
				limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
				custom_tooltip = {
					fail_text = unity_fail_text
					has_country_resource = { type = unity amount >= monthly_unity_prod }
				}
			}
			any_owned_leader = { leader_class = scientist }
		}
		hidden_effect = { get_scientists_heir = yes }
		ai_chance = { factor = 1 }
	}

	# Just disinherit them
	option = {
		name = usefulheirs.3000.e
		hidden_effect = {
			if = {
				limit =  { has_global_flag = civil_wars_active }
				if = {
					log = "HEIR EVENT"
					limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
					heir_setup_non_ad_just_disinherit = yes
				}
				else_if = {
					limit = {
						has_valid_civic = civic_adoptive_dynasties
						heir = { has_leader_flag = appointed_heir }
					}
					heir_setup_ad_just_disinherit = yes
				}
			}
			heir = { kill_leader = { show_notification = no } }
		}
		ai_chance = { factor = 0 }
	}
}

# Governor
country_event = {
	id = usefulheirs.3110
	title = usefulheirs.3110.name
	desc = usefulheirs.3110.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Nevermind
	option = {
		name = usefulheirs.3110.back
		ai_chance = {
			factor = 0.5
		}
	}

	option = {
		name = usefulheirs.3110.heir_maybe_1
		trigger = { check_variable = { which = total_governors value >= 1 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_1 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_2
		trigger = { check_variable = { which = total_governors value >= 2 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_2 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_3
		trigger = { check_variable = { which = total_governors value >= 3 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_3 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_4
		trigger = { check_variable = { which = total_governors value >= 4 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_4 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_5
		trigger = { check_variable = { which = total_governors value >= 5 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_5 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_6
		trigger = { check_variable = { which = total_governors value >= 6 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_6 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_7
		trigger = { check_variable = { which = total_governors value >= 7 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_7 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_8
		trigger = { check_variable = { which = total_governors value >= 8 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_8 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_9
		trigger = { check_variable = { which = total_governors value >= 9 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_9 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_10
		trigger = { check_variable = { which = total_governors value >= 10 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_10 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	after = {
		hidden_effect = { clear_variable = monthly_unity_prod }
	}
}

# Admiral
country_event = {
	id = usefulheirs.3120
	title = usefulheirs.3120.name
	desc = usefulheirs.3110.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Nevermind
	option = {
		name = usefulheirs.3110.back
		ai_chance = {
			factor = 0.5
		}
	}

	option = {
		name = usefulheirs.3110.heir_maybe_1
		trigger = { check_variable = { which = total_admirals value >= 1 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_1 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_2
		trigger = { check_variable = { which = total_admirals value >= 2 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_2 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_3
		trigger = { check_variable = { which = total_admirals value >= 3 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_3 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_4
		trigger = { check_variable = { which = total_admirals value >= 4 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_4 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_5
		trigger = { check_variable = { which = total_admirals value >= 5 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_5 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_6
		trigger = { check_variable = { which = total_admirals value >= 6 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_6 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_7
		trigger = { check_variable = { which = total_admirals value >= 7 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_7 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_8
		trigger = { check_variable = { which = total_admirals value >= 8 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_8 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_9
		trigger = { check_variable = { which = total_admirals value >= 9 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_9 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_10
		trigger = { check_variable = { which = total_admirals value >= 10 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_10 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	after = {
		hidden_effect = { clear_variable = monthly_unity_prod }
	}
}

# General
country_event = {
	id = usefulheirs.3130
	title = usefulheirs.3130.name
	desc = usefulheirs.3110.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Nevermind
	option = {
		name = usefulheirs.3110.back
		ai_chance = {
			factor = 0.5
		}
	}

	option = {
		name = usefulheirs.3110.heir_maybe_1
		trigger = { check_variable = { which = total_generals value >= 1 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_1 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_2
		trigger = { check_variable = { which = total_generals value >= 2 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_2 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_3
		trigger = { check_variable = { which = total_generals value >= 3 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_3 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_4
		trigger = { check_variable = { which = total_generals value >= 4 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_4 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_5
		trigger = { check_variable = { which = total_generals value >= 5 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_5 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_6
		trigger = { check_variable = { which = total_generals value >= 6 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_6 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_7
		trigger = { check_variable = { which = total_generals value >= 7 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_7 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_8
		trigger = { check_variable = { which = total_generals value >= 8 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_8 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_9
		trigger = { check_variable = { which = total_generals value >= 9 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_9 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_10
		trigger = { check_variable = { which = total_generals value >= 10 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_10 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	after = {
		hidden_effect = { clear_variable = monthly_unity_prod }
	}
}

# Scientist
country_event = {
	id = usefulheirs.3140
	title = usefulheirs.3140.name
	desc = usefulheirs.3110.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = root.capital_scope
		graphical_culture = root.owner
		city_level = root.capital_scope
		room = root.ruler
	}

	# Nevermind
	option = {
		name = usefulheirs.3110.back
		ai_chance = {
			factor = 0.5
		}
	}

	option = {
		name = usefulheirs.3110.heir_maybe_1
		trigger = { check_variable = { which = total_scientists value >= 1 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_1 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_2
		trigger = { check_variable = { which = total_scientists value >= 2 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_2 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_3
		trigger = { check_variable = { which = total_scientists value >= 3 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_3 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_4
		trigger = { check_variable = { which = total_scientists value >= 4 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_4 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_5
		trigger = { check_variable = { which = total_scientists value >= 5 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_5 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_6
		trigger = { check_variable = { which = total_scientists value >= 6 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_6 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_7
		trigger = { check_variable = { which = total_scientists value >= 7 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_7 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_8
		trigger = { check_variable = { which = total_scientists value >= 8 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_8 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_9
		trigger = { check_variable = { which = total_scientists value >= 9 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_9 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	option = {
		name = usefulheirs.3110.heir_maybe_10
		trigger = { check_variable = { which = total_scientists value >= 10 } }
		if = {
			limit = { NOT = { has_valid_civic = civic_adoptive_dynasties } }
			add_resource = {
				unity = -1
				mult = monthly_unity_prod
			}
		}		
		hidden_effect = {
			event_target:heir_maybe_10 = {
				save_event_target_as = new_chosen_heir
				set_leader_flag = appointed_heir
			}
			if = {
				limit = { has_valid_civic = civic_adoptive_dynasties }
				heir_setup_ad = yes
			}
			else = {
				heir_setup_non_ad = yes
			}
		}
		ai_chance = { factor = 1 }
	}

	after = {
		hidden_effect = { clear_variable = monthly_unity_prod }
	}
}

#############################

# New Heir - Adopt Dynastic Name?
country_event = {
	id = usefulheirs.3500
	picture = GFX_evt_arena
	title = usefulheirs.3500.name
	desc = usefulheirs.3500.desc
	hide_window = no
	is_triggered_only = yes

	immediate = {
		random_owned_leader = {
			limit = { has_leader_flag = dynastic_name_leader }
			save_event_target_as = dynastic_name_leader
		}
	}

	# No Name Change
	option = {
		name = usefulheirs.3500.no_name_change
	}

	# Yes Name Change
	option = {
		name = usefulheirs.3500.yes_name_change
		custom_tooltip = usefulheirs.3500.yes_name_change.tooltip
		hidden_effect = {
			heir = {
				set_name = {
					key = "usefulheirs.3500.new_heir_name"
					variable_string = "[this.GetName]"
					variable_string = "[event_target:dynastic_name_leader.GetName]"
				}
				set_leader_flag = adopted_dynastic_name
			}
		}
	}

	after = {
		hidden_effect = {
			if = {
				limit = { has_country_flag = dissed_heir }
				country_event = { id = usefulheirs.3501 }
			}
		}
	}
}

# New Heir Proclaimed, but old heir is upset
country_event = {
	id = usefulheirs.3501
	picture = GFX_evt_coronation
	title = usefulheirs.3501.name
	desc = usefulheirs.3501.desc
	hide_window = no
	is_triggered_only = yes

	trigger = {
		has_country_flag = dissed_heir
	}

	immediate = {
		remove_country_flag = dissed_heir
	}

	option = {
		name = response_they_shall_accept
		hidden_effect = {
			every_owned_planet = {
				limit = {
					num_pops > 0
					is_capital = no
				}
				add_modifier = {
					modifier = chose_new_heir
					days = 720
				}
			}
			capital_scope = {
				add_modifier = {
					modifier = chose_new_heir_capital
					days = 2520
				}
			}
			if = {
				limit = { has_global_flag = civil_wars_active }
				country_event = { id = civheir.1000 }
			}
		}
	}
}

# Check for dynastic heir and set flag monthly
country_event = {
	id = usefulheirs.3600
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_imperial = yes
		has_civic = civic_adoptive_dynasties
		exists = heir
		heir = { NOT = { has_leader_flag = dynastic_heir } }
		heir = { NOT = { has_leader_flag = appointed_heir } }
	}

	immediate = {
		heir = { set_leader_flag = dynastic_heir }
	}
}

# On Ruler set, if dynastic heir, set penalties
country_event = {
	id = usefulheirs.3800
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_imperial = yes
		has_civic = civic_adoptive_dynasties
		ruler = { has_leader_flag = dynastic_heir }
	}

	immediate = {
		country_event = { id = usefulheirs.3810 days = 7 }
	}
}

# New Non-Designated Ruler
country_event = {
	id = usefulheirs.3810
	picture = GFX_evt_news_room
	title = usefulheirs.3810.name
	desc = usefulheirs.3810.desc
	hide_window = no
	is_triggered_only = yes

	option = {
		name = usefulheirs.3810.a
		hidden_effect = {
			every_owned_planet = {
				limit = {
					num_pops > 0
					is_capital = no
				}
				add_modifier = {
					modifier = dynastic_heir
					days = 3600
				}
			}
			capital_scope = {
				add_modifier = {
					modifier = dynastic_heir_capital
					days = 3600
				}
			}
			event_target:deceased_ruler = {
				kill_leader = { show_notification = no }
			}
		}
	}
}

# Dead Designated Heir - Initializer
country_event = {
	id = usefulheirs.3900
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = {
			has_leader_flag = appointed_heir
			NOT = { has_leader_flag = dead_ruler }
			NOT = { has_leader_flag = switch_ruler }
		}
		has_civic = civic_adoptive_dynasties
	}

	immediate = {
		from = { save_event_target_as = deceased_heir }
		clone_leader = {
			target = event_target:deceased_heir
			effect = {
				set_leader_flag = dead_ruler
				save_event_target_as = deceased_heir
			}
		}
		country_event = { id = usefulheirs.3910 }
	}
}

# Designated Heir Dies - Notification
country_event = {
	id = usefulheirs.3910
	picture = GFX_evt_space_funeral
	title = usefulheirs.3910.name
	desc = usefulheirs.3910.desc
	hide_window = no
	is_triggered_only = yes

	option = {
		name = usefulheirs.3910.a
		hidden_effect = {
			event_target:deceased_heir = {
				kill_leader = { show_notification = no }
			}
		}
	}
}

#############################

# Abdicate the Throne
country_event = {
	id = usefulheirs.4000
	title = usefulheirs.4000.name
	desc = usefulheirs.4000.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:heir_leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}

	# Nevermind
	option = {
		name = usefulheirs.4000.a
		trigger = {
			is_ai = no
		}
	}

	# I am sure. I intend to retire.
	option = {
		name = usefulheirs.4000.b
		custom_tooltip = usefulheirs.4000.b.tooltip
		hidden_effect = { ruler = { kill_leader = { show_notification = no } } }
		ai_chance = { factor = 5 }
	}

	# I am sure. However, I still plan to contribute.
	option = {
		name = usefulheirs.4000.c
		custom_tooltip = usefulheirs.4000.c.tooltip
		hidden_effect = { country_event = { id = usefulheirs.4010 } }
		ai_chance = { factor = 1 }
	}
}

# Decide to become another leader type
country_event = {
	id = usefulheirs.4010
	title = usefulheirs.4010.name
	desc = usefulheirs.4010.desc
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:heir_leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}

	# Governor
	option = {
		name = usefulheirs.4010.a
		hidden_effect = { country_event = { id = usefulheirs.4011 } }
		ai_chance = { factor = 5 }
	}

	# Admiral
	option = {
		name = usefulheirs.4010.b
		hidden_effect = { country_event = { id = usefulheirs.4012 } }
		ai_chance = { factor = 4 }
	}

	# General
	option = {
		name = usefulheirs.4010.c
		hidden_effect = { country_event = { id = usefulheirs.4013 } }
		ai_chance = { factor = 2 }
	}

	# Scientist
	option = {
		name = usefulheirs.4010.d
		hidden_effect = { country_event = { id = usefulheirs.4014 } }
		ai_chance = { factor = 2 }
	}
}

# Make Ruler Governor
country_event = {
	id = usefulheirs.4011
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		ruler = { save_event_target_as = old_ruler }

		heir = {
			save_event_target_as = new_ruler
			set_leader_flag = new_ruler_via_abdication
		}

		clone_leader = {
			target = event_target:old_ruler
			class = governor
			effect = {
				set_leader_flag = abdicated_ruler
				save_event_target_as = abdicated_ruler_new
			}
		}

		ruler = { kill_leader = { show_notification = no } }
	}
}

# Make Ruler Admiral
country_event = {
	id = usefulheirs.4012
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		ruler = { save_event_target_as = old_ruler }

		heir = {
			save_event_target_as = new_ruler
			set_leader_flag = new_ruler_via_abdication
		}

		clone_leader = {
			target = event_target:old_ruler
			class = admiral
			effect = {
				set_leader_flag = abdicated_ruler
				save_event_target_as = abdicated_ruler_new
			}
		}

		ruler = { kill_leader = { show_notification = no } }
	}
}

# Make Ruler General
country_event = {
	id = usefulheirs.4013
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		ruler = { save_event_target_as = old_ruler }

		heir = {
			save_event_target_as = new_ruler
			set_leader_flag = new_ruler_via_abdication
		}

		clone_leader = {
			target = event_target:old_ruler
			class = general
			effect = {
				set_leader_flag = abdicated_ruler
				save_event_target_as = abdicated_ruler_new
			}
		}

		ruler = { kill_leader = { show_notification = no } }
	}
}

# Make Ruler Scientist
country_event = {
	id = usefulheirs.4014
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		ruler = { save_event_target_as = old_ruler }

		heir = {
			save_event_target_as = new_ruler
			set_leader_flag = new_ruler_via_abdication
		}

		clone_leader = {
			target = event_target:old_ruler
			class = scientist
			effect = {
				set_leader_flag = abdicated_ruler
				save_event_target_as = abdicated_ruler_new
			}
		}

		ruler = { kill_leader = { show_notification = no } }
	}
}

#############################

# AI Heir Leader event
country_event = {
	id = usefulheirs.9000
	hide_window = yes
	is_triggered_only = yes

	trigger = { 
		is_ai = yes
		exists = heir
		heir = {
			NOR = {
				leader_class = governor
				leader_class = admiral
				leader_class = general
				leader_class = scientist
			}
		}
	}

	immediate = {
		heir = { save_event_target_as = heir_leader }
		country_event = { id = usefulheirs.2000 }
	}
}

# AI Abdication event
country_event = {
	id = usefulheirs.9001
	hide_window = yes
	is_triggered_only = yes

	trigger = { 
		is_ai = yes
		exists = heir
		is_at_war = no
		ruler = {
			NOT = {
				has_trait = leader_trait_ruler_chosen
			}
		}
	}

	immediate = {
		if = {
			limit = {
				ruler = {
					leader_age >= 70
					leader_age < 75
				}
			}
			random_list = {
				10 = { country_event = { id = usefulheirs.4000 } }
				90 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 75
					leader_age < 80
				}
			}
			random_list = {
				15 = { country_event = { id = usefulheirs.4000 } }
				85 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 80
					leader_age < 85
				}
			}
			random_list = {
				20 = { country_event = { id = usefulheirs.4000 } }
				80 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 85
					leader_age < 90
				}
			}
			random_list = {
				25 = { country_event = { id = usefulheirs.4000 } }
				75 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 90
					leader_age < 95
				}
			}
			random_list = {
				30 = { country_event = { id = usefulheirs.4000 } }
				70 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 95
					leader_age < 100
				}
			}
			random_list = {
				35 = { country_event = { id = usefulheirs.4000 } }
				65 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 100
					leader_age < 105
				}
			}
			random_list = {
				40 = { country_event = { id = usefulheirs.4000 } }
				60 = { }
			}
		}
		else_if = {
			limit = {
				ruler = {
					leader_age >= 105
				}
			}
			random_list = {
				45 = { country_event = { id = usefulheirs.4000 } }
				55 = { }
			}
		}
	}
}

# AI Designate Heir event
country_event = {
	id = usefulheirs.9002
	hide_window = yes
	is_triggered_only = yes

	trigger = { 
		is_ai = yes
		exists = heir
		has_valid_civic = civic_adoptive_dynasties
		heir = { NOT = { has_leader_flag = appointed_heir } }
	}

	immediate = {
		heir = { save_event_target_as = heir_leader }
		country_event = { id = usefulheirs.3000 }
	}
}

# AI Random Chance to Designate a leader as heir event event
country_event = {
	id = usefulheirs.9003
	hide_window = yes
	is_triggered_only = yes

	trigger = { 
		is_ai = yes
		exists = heir
	}

	immediate = {

		random_list = {
			# Nothing
			97 = { }
			# Heir Disinherited
			3 = {
				heir = { save_event_target_as = heir_leader }
				country_event = { id = usefulheirs.3000 }
			}
		}
	}
}

# Remove heir flag from ruler
country_event = {
	id = usefulheirs.9100
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = { has_global_flag = civil_wars_active }
		ruler = { has_leader_flag = appointed_heir }
	}

	immediate = {
		ruler = {
			remove_leader_flag = appointed_heir
			set_leader_flag = appointed_heir_ruler
		}
	}
}

# Change Country Species to new ruler species so new heirs are of the new species
country_event = {
	id = usefulheirs.9200
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_imperial = yes
		ruler = { NOT = { is_exact_same_species = owner_species } }
	}

	immediate = {
		change_dominant_species = { species = ruler.species }
	}
}

# On Ruler set, save dynastic name
country_event = {
	id = usefulheirs.9300
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_imperial = yes
		ruler = { NOT = { has_leader_flag = adopted_dynastic_name } }
	}

	immediate = {
		if = {
			limit = { NOT = { any_owned_leader = { has_leader_flag = dynastic_name_leader } } }
			create_leader = {
				class = ruler
				species = owner_main_species
				name = random
				immortal = yes
				event_leader = yes
				effect = {
					set_leader_flag = dummy_leader
					set_leader_flag = dynastic_name_leader
					set_name = {
						key = saved_dynastic_name
						variable_string = "[root.ruler.GetSecondName]"
					}
				}
			}
		}
		else = {
			random_owned_leader = {
				limit = { has_leader_flag = dynastic_name_leader }
				set_name = {
					key = saved_dynastic_name
					variable_string = "[root.ruler.GetSecondName]"
				}
			}
		}		
	}
}

# Uncivic Compatch
leader_event = {
	id = usefulheirs.9400
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		owner = { is_imperial = yes }
		from = { has_leader_flag = appointed_heir }
	}

	immediate = {
		set_leader_flag = appointed_heir
		if = {
		    limit = { from = { has_leader_flag = adopted_dynastic_name } }
		    set_leader_flag = adopted_dynastic_name
		}
		owner = { set_heir = root }
	}
}

# Psionic Fix - Give heir correct trait
country_event = {
	id = usefulheirs.9500
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = heir
		heir = {
			has_trait = leader_trait_ruler_psionic
			NOR = {
				has_trait = leader_trait_governor_psionic
				has_trait = leader_trait_admiral_psionic
				has_trait = leader_trait_general_psionic
				has_trait = leader_trait_scientist_psionic
			}
			OR = {
				leader_class = governor
				leader_class = admiral
				leader_class = general
				leader_class = scientist
			}
		}
	}

	immediate = {

		heir = {
			if = {
				limit = { leader_class = governor }
				add_trait = leader_trait_governor_psionic
			}
			else_if = {
				limit = { leader_class = admiral }
				add_trait = leader_trait_admiral_psionic
			}
			else_if = {
				limit = { leader_class = general }
				add_trait = leader_trait_general_psionic
			}
			else_if = {
				limit = { leader_class = scientist }
				add_trait = leader_trait_scientist_psionic
			}
		}
	}
}

# Psionic Fix - Remove traits after switching jobs
country_event = {
	id = usefulheirs.9510
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = heir
		heir = {
			OR = {
				AND = {
					has_trait = leader_trait_governor_psionic
					OR = {
						has_trait = leader_trait_admiral_psionic
						has_trait = leader_trait_general_psionic
						has_trait = leader_trait_scientist_psionic
					}
				}
				AND = {
					has_trait = leader_trait_admiral_psionic
					OR = {
						has_trait = leader_trait_governor_psionic
						has_trait = leader_trait_general_psionic
						has_trait = leader_trait_scientist_psionic
					}
				}
				AND = {
					has_trait = leader_trait_general_psionic
					OR = {
						has_trait = leader_trait_governor_psionic
						has_trait = leader_trait_admiral_psionic
						has_trait = leader_trait_scientist_psionic
					}
				}
				AND = {
					has_trait = leader_trait_scientist_psionic
					OR = {
						has_trait = leader_trait_governor_psionic
						has_trait = leader_trait_admiral_psionic
						has_trait = leader_trait_scientist_psionic
					}
				}
			}
		}
	}

	immediate = {

		heir = {
			if = {
				limit = { leader_class = governor }
				if = {
					limit = { has_trait = leader_trait_admiral_psionic }
					remove_trait = leader_trait_admiral_psionic
				}
				if = {
					limit = { has_trait = leader_trait_general_psionic }
					remove_trait = leader_trait_general_psionic
				}
				if = {
					limit = { has_trait = leader_trait_scientist_psionic }
					remove_trait = leader_trait_scientist_psionic
				}
			}
			else_if = {
				limit = { leader_class = admiral }
				if = {
					limit = { has_trait = leader_trait_governor_psionic }
					remove_trait = leader_trait_governor_psionic
				}
				if = {
					limit = { has_trait = leader_trait_general_psionic }
					remove_trait = leader_trait_general_psionic
				}
				if = {
					limit = { has_trait = leader_trait_scientist_psionic }
					remove_trait = leader_trait_scientist_psionic
				}
			}
			else_if = {
				limit = { leader_class = general }
				if = {
					limit = { has_trait = leader_trait_admiral_psionic }
					remove_trait = leader_trait_admiral_psionic
				}
				if = {
					limit = { has_trait = leader_trait_governor_psionic }
					remove_trait = leader_trait_governor_psionic
				}
				if = {
					limit = { has_trait = leader_trait_scientist_psionic }
					remove_trait = leader_trait_scientist_psionic
				}
			}
			else_if = {
				limit = { leader_class = scientist }
				if = {
					limit = { has_trait = leader_trait_admiral_psionic }
					remove_trait = leader_trait_admiral_psionic
				}
				if = {
					limit = { has_trait = leader_trait_general_psionic }
					remove_trait = leader_trait_general_psionic
				}
				if = {
					limit = { has_trait = leader_trait_governor_psionic }
					remove_trait = leader_trait_governor_psionic
				}
			}
		}
	}
}

# Set Realistic Heir Ages
country_event = {
	id = usefulheirs.9600
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = heir
		heir = {
			NOR = {
				has_leader_flag = heir_age_set
				has_leader_flag = appointed_heir
			}
		}
		ruler = { NOT = { has_trait = leader_trait_ruler_chosen } }
	}

	immediate = {

		set_variable = { which = ruler_age_for_calc_1 value = leader.trigger:leader_age }
		set_variable = { which = ruler_age_for_calc_2 value = leader.trigger:leader_age }
		set_variable = { which = heir_age value = heir.trigger:leader_age }

		subtract_variable = {
			which = ruler_age_for_calc_1
			value = heir_age
		}

		if = {
			limit = { heir.species = { NOT = { has_trait = trait_venerable } } }
			if = {
				limit = { check_variable = { which = ruler_age_for_calc_1 value >= 50 } }
				random_list = {
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 15 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 16 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 17 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 18 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 19 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 20 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 21 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 22 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 23 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 24 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 25 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 26 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 27 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 28 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 29 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 30 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 31 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 32 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 33 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 34 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 35 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 36 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 37 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 38 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 39 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 40 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 41 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 42 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 43 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 44 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 45 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 46 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 47 } }
				}
				heir = {
					set_age = prev.ruler_age_for_calc_2
					set_leader_flag = heir_age_set
				}
			}
			else = {
				heir = { set_leader_flag = heir_age_set }
			}
		}
		else = {
			if = {
				limit = { check_variable = { which = ruler_age_for_calc_1 value >= 100 } }
				random_list = {
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 30 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 31 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 32 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 33 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 34 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 35 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 36 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 37 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 38 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 39 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 40 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 41 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 42 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 43 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 44 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 45 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 46 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 47 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 48 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 49 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 50 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 51 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 52 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 53 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 54 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 55 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 56 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 57 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 58 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 59 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 60 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 61 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 62 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 63 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 64 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 65 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 66 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 67 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 68 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 69 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 70 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 71 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 72 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 73 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 74 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 75 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 76 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 77 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 78 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 79 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 80 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 81 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 82 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 83 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 84 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 85 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 86 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 87 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 88 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 89 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 90 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 91 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 92 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 93 } }
					1 = { subtract_variable = { which = ruler_age_for_calc_2 value = 94 } }
				}
				heir = {
					set_age = prev.ruler_age_for_calc_2
					set_leader_flag = heir_age_set
				}
			}
			else = {
				heir = { set_leader_flag = heir_age_set }
			}
		}

		clear_variable = ruler_age_for_calc_1
		clear_variable = ruler_age_for_calc_2
		clear_variable = heir_age
	}
}
